{"version":3,"sources":["utils/reorder.ts","utils/use-optimistic-options.ts","utils/user.ts","components/id-select.tsx","components/user-select.tsx","screens/project-list/search-panel.tsx","components/pin.tsx","utils/project.ts","utils/url.ts","screens/project-list/util.ts","screens/project-list/list.tsx","components/profiler.tsx","screens/project-list/index.tsx","assets/software-logo.svg","utils/task.ts","screens/kanban/util.ts","utils/task-type.ts","assets/task.svg","assets/bug.svg","screens/kanban/create-task.tsx","components/mark.tsx","utils/kanban.ts","components/drag-and-drop.tsx","screens/kanban/kanban-column.tsx","components/task-type-select.tsx","screens/kanban/search-panel.tsx","screens/kanban/create-kanban.tsx","utils/epic.ts","components/epic-select.tsx","screens/kanban/task-modal.tsx","screens/kanban/index.tsx","screens/epic/util.ts","screens/epic/create-epic.tsx","screens/epic/epic-modal.tsx","screens/epic/index.tsx","screens/project/index.tsx","screens/project-list/project-modal.tsx","components/project-popover.tsx","components/create-user.tsx","components/user-popover.tsx","authenticated-app.tsx"],"names":["reorder","fromId","type","referenceId","list","copiedList","movingItemIndex","findIndex","item","id","insertAfter","length","targetIndex","insertBefore","from","to","toItem","removedItem","splice","toIndex","indexOf","useConfig","queryKey","callback","queryClient","useQueryClient","onSuccess","invalidateQueries","onMutate","target","previousItems","getQueryData","setQueryData","old","onError","error","newItem","context","useDeleteConfig","filter","useEditConfig","map","useAddConfig","useUsers","param","client","useHttp","useQuery","data","IdSelect","props","value","onChange","defaultOptionName","options","restProps","find","toNumber","undefined","Option","option","key","name","isNaN","Number","UserSelect","users","SearchPanel","setParam","style","marginBottom","layout","Item","placeholder","evt","personId","Pin","checked","onCheckedChange","count","num","useProjects","cleanObject","useEditProject","useMutation","params","method","useAddProject","useProject","enabled","Boolean","useUrlQueryParam","keys","useSearchParams","searchParams","setSearchParams","useSetUrlSearchParam","useState","stateKeys","useMemo","subset","Object","fromEntries","setSearchParam","o","useProjectsSearchParams","useProjectsQueryKey","useProjectModal","projectCreate","setProjectCreate","editingProjectId","setEditingProjectId","setUrlParams","editingProject","isLoading","projectModalOpen","open","close","startEdit","List","mutate","rowKey","pagination","columns","title","disabled","render","project","pin","sorter","a","b","localeCompare","String","dataIndex","user","created","moment","format","More","deleteProject","useDeleteProject","overlay","onClick","Modal","confirm","content","okText","onOk","confirmDeleteProject","queue","setInterval","queueToSend","console","log","Profiler","metadata","phases","onRender","phase","actualDuration","baseDuration","startTime","commitTime","interactions","includes","push","ProjectListScreen","useDocumentTitle","useDebounce","between","loading","dataSource","whyDidYouRender","_defs","_g","_extends","assign","i","arguments","source","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgSoftwareLogo","_ref","svgRef","titleId","viewBox","xmlns","focusable","className","ref","x1","y1","x2","y2","stopColor","offset","stroke","strokeWidth","fillRule","d","fill","ForwardRef","useTasks","useReorderTask","kanbanId","toKanbanId","useReorderTaskConfig","useProjectIdInUrl","useLocation","pathname","match","useProjectInUrl","useKanbanSearchParams","projectId","useKanbansQueryKey","useTasksSearchParams","debouncedName","typeId","processorId","tagId","useTasksQueryKey","useTasksModal","editingTaskId","setEditingTaskId","useTask","editingTask","useCallback","useTaskTypes","CreateTask","setName","addTask","useAddTask","mutateAsync","inputMode","setInputMode","submit","toggle","mode","useEffect","onBlur","autoFocus","onPressEnter","Mark","keyword","arr","split","str","index","color","useKanbans","useReorderKanban","useReorderKanbanConfig","Drop","children","provided","React","isValidElement","cloneElement","droppableProps","innerRef","DropChild","forwardRef","Drag","draggableProps","dragHandleProps","TaskTypeIcon","taskTypes","taskType","alt","src","taskIcon","bugIcon","TaskCard","task","cursor","KanbanColumn","kanban","allTasks","tasks","Container","TasksContainer","direction","droppableId","minHeight","taskIndex","draggableId","useDeleteKanban","cancelText","styled","div","TaskTypeSelect","gap","width","CreateKanban","addKanban","useAddKanban","size","useEpics","EpicSelect","epics","labelCol","span","wrapperCol","TaskModal","Form","useForm","form","useEditTask","editTask","editLoading","deleteTask","useDeleteTask","getFieldsValue","setFieldsValue","forceRender","onCancel","resetFields","confirmLoading","visible","initialValues","label","rules","required","message","TextArea","textAlign","fontSize","danger","KanbanScreen","currentProject","kanbans","kanbanIsLoading","onDragEnd","useDragEnd","ColumnsContainer","display","reorderKanban","reorderTask","destination","toId","fromKanbanId","fromTask","toTask","useEpicSearchParams","useEpicsQueryKey","useEpicsModal","editingEpicId","setEditingEpicId","useEpic","editingEpic","CreateEpic","useAddEpic","addEpic","onFinish","values","onClose","destroyOnClose","htmlType","EpicModal","useEditEpic","editEpic","start","end","EpicScreen","deleteEpic","useDeleteEpic","epicCreateOpen","setEpicCreateOpen","overflow","itemLayout","renderItem","epic","Meta","confirmDeleteEpic","description","epicId","margin","ProjectScreen","routeType","units","useRouteType","Aside","selectedKeys","Main","path","element","window","location","replace","aside","ProjectModal","mutateLoading","then","ProjectPopover","projects","refetch","pinnedProjects","ContentContainer","Text","onVisibleChange","placement","CursorPointer","CreateUser","addUser","useAddUser","UserPopover","deleteUser","useDeleteUser","Flex","startDelete","AuthenticatedApp","PageHeader","Header","HeaderLeft","resetRoute","HeaderRight","User","useAuth","logout","e","preventDefault","Row","main"],"mappings":"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","file":"static/js/5.f5ff28c0.chunk.js","sourcesContent":["/**\r\n * 在本地对排序进行乐观更新\r\n * @param fromId 要排序的项目的id\r\n * @param type 'before' | 'after'\r\n * @param referenceId 参照id\r\n * @param list 要排序的列表, 比如tasks, kanbans\r\n */\r\nexport const reorder = ({\r\n  fromId,\r\n  type,\r\n  referenceId,\r\n  list,\r\n}: {\r\n  list: { id: number }[];\r\n  fromId: number;\r\n  type: \"after\" | \"before\";\r\n  referenceId: number;\r\n}) => {\r\n  const copiedList = [...list];\r\n  // 找到fromId对应项目的下标\r\n  const movingItemIndex = copiedList.findIndex((item) => item.id === fromId);\r\n  if (!referenceId) {\r\n    return insertAfter([...copiedList], movingItemIndex, copiedList.length - 1);\r\n  }\r\n  const targetIndex = copiedList.findIndex((item) => item.id === referenceId);\r\n  const insert = type === \"after\" ? insertAfter : insertBefore;\r\n  return insert([...copiedList], movingItemIndex, targetIndex);\r\n};\r\n\r\n/**\r\n * 在list中，把from放在to的前边\r\n * @param list\r\n * @param from\r\n * @param to\r\n */\r\nconst insertBefore = (list: unknown[], from: number, to: number) => {\r\n  const toItem = list[to];\r\n  const removedItem = list.splice(from, 1)[0];\r\n  const toIndex = list.indexOf(toItem);\r\n  list.splice(toIndex, 0, removedItem);\r\n  return list;\r\n};\r\n\r\n/**\r\n * 在list中，把from放在to的后面\r\n * @param list\r\n * @param from\r\n * @param to\r\n */\r\nconst insertAfter = (list: unknown[], from: number, to: number) => {\r\n  const toItem = list[to];\r\n  const removedItem = list.splice(from, 1)[0];\r\n  const toIndex = list.indexOf(toItem);\r\n  list.splice(toIndex + 1, 0, removedItem);\r\n  return list;\r\n};\r\n","import { QueryKey, useQueryClient } from \"react-query\";\r\nimport { reorder } from \"utils/reorder\";\r\nimport { Task } from \"types/task\";\r\n\r\nexport const useConfig = (\r\n  queryKey: QueryKey,\r\n  callback: (target: any, old?: any[]) => any[]\r\n) => {\r\n  const queryClient = useQueryClient();\r\n  return {\r\n    onSuccess: () => queryClient.invalidateQueries(queryKey),\r\n    async onMutate(target: any) {\r\n      const previousItems = queryClient.getQueryData(queryKey);\r\n      queryClient.setQueryData(queryKey, (old?: any[]) => {\r\n        return callback(target, old);\r\n      });\r\n      return { previousItems };\r\n    },\r\n    onError(error: any, newItem: any, context: any) {\r\n      queryClient.setQueryData(queryKey, context.previousItems);\r\n    },\r\n  };\r\n};\r\n\r\nexport const useDeleteConfig = (queryKey: QueryKey) =>\r\n  useConfig(\r\n    queryKey,\r\n    (target, old) => old?.filter((item) => item.id !== target.id) || []\r\n  );\r\nexport const useEditConfig = (queryKey: QueryKey) =>\r\n  useConfig(\r\n    queryKey,\r\n    (target, old) =>\r\n      old?.map((item) =>\r\n        item.id === target.id ? { ...item, ...target } : item\r\n      ) || []\r\n  );\r\nexport const useAddConfig = (queryKey: QueryKey) =>\r\n  useConfig(queryKey, (target, old) => (old ? [...old, target] : []));\r\n\r\nexport const useReorderKanbanConfig = (queryKey: QueryKey) =>\r\n  useConfig(queryKey, (target, old) => reorder({ list: old, ...target }));\r\n\r\nexport const useReorderTaskConfig = (queryKey: QueryKey) =>\r\n  useConfig(queryKey, (target, old) => {\r\n    const orderedList = reorder({ list: old, ...target }) as Task[];\r\n    return orderedList.map((item) =>\r\n      item.id === target.fromId\r\n        ? { ...item, kanbanId: target.toKanbanId }\r\n        : item\r\n    );\r\n  });\r\n","import { useHttp } from \"utils/http\";\r\nimport { User } from \"types/user\";\r\nimport { QueryKey, useMutation, useQuery } from \"react-query\";\r\nimport { useAddConfig, useDeleteConfig } from \"./use-optimistic-options\";\r\n\r\nexport const useUsers = (param?: Partial<User>) => {\r\n  const client = useHttp();\r\n\r\n  return useQuery<User[]>([\"users\", param], () =>\r\n    client(\"users\", { data: param })\r\n  );\r\n};\r\n\r\n\r\nexport const useAddUser = () => {\r\n  const client = useHttp();\r\n\r\n  return useMutation(\r\n    (params: Partial<User>) =>\r\n      client(`users`, {\r\n        data: params,\r\n        method: \"POST\",\r\n      }),\r\n    useAddConfig(\"users\")\r\n  );\r\n};\r\n\r\nexport const useDeleteUser = () => {\r\n  const client = useHttp();\r\n\r\n  return useMutation(\r\n    ({ id }: { id: number }) =>\r\n      client(`users/${id}`, {\r\n        method: \"DELETE\",\r\n      }),\r\n    useDeleteConfig(\"users\")\r\n  );\r\n};","import React from \"react\";\r\nimport { Raw } from \"types\";\r\nimport { Select } from \"antd\";\r\n\r\ntype SelectProps = React.ComponentProps<typeof Select>;\r\n\r\ninterface IdSelectProps\r\n  extends Omit<SelectProps, \"value\" | \"onChange\" | \"options\"> {\r\n  value?: Raw | null | undefined;\r\n  onChange?: (value?: number) => void;\r\n  defaultOptionName?: string;\r\n  options?: { name: string; id: number }[];\r\n}\r\n\r\n/**\r\n * value 可以传入多种类型的值\r\n * onChange只会回调 number|undefined 类型\r\n * 当 isNaN(Number(value)) 为true的时候，代表选择默认类型\r\n * 当选择默认类型的时候，onChange会回调undefined\r\n * @param props\r\n * @constructor\r\n */\r\nexport const IdSelect = (props: IdSelectProps) => {\r\n  const { value, onChange, defaultOptionName, options, ...restProps } = props;\r\n  \r\n  return (\r\n    <Select\r\n      value={options?.length \r\n        ? options.find(item=>item.id === toNumber(value))\r\n          ? toNumber(value)\r\n          : 0\r\n        : 0}\r\n      onChange={(value) => onChange?.(toNumber(value) || undefined)}\r\n      {...restProps}\r\n    >\r\n      {defaultOptionName ? (\r\n        <Select.Option value={0}>{defaultOptionName}</Select.Option>\r\n      ) : null}\r\n      {options?.map((option) => (\r\n        <Select.Option key={option.id} value={option.id}>\r\n          {option.name}\r\n        </Select.Option>\r\n      ))}\r\n    </Select>\r\n  );\r\n};\r\n\r\nconst toNumber = (value: unknown) => (isNaN(Number(value)) ? 0 : Number(value));\r\n","import React from \"react\";\r\nimport { useUsers } from \"utils/user\";\r\nimport { IdSelect } from \"components/id-select\";\r\n\r\nexport const UserSelect = (props: React.ComponentProps<typeof IdSelect>) => {\r\n  const { data: users } = useUsers();\r\n  return <IdSelect options={users || []} {...props} />;\r\n};\r\n","import React from \"react\";\r\nimport { Form, Input } from \"antd\";\r\nimport { UserSelect } from \"components/user-select\";\r\nimport { Project } from \"types/project\";\r\nimport { User } from \"types/user\";\r\n\r\ninterface SearchPanelProps {\r\n  users: User[];\r\n  param: Partial<Pick<Project, \"name\" | \"personId\">>;\r\n  setParam: (param: SearchPanelProps[\"param\"]) => void;\r\n}\r\n\r\nexport const SearchPanel = ({ users, param, setParam }: SearchPanelProps) => {\r\n  return (\r\n    <Form style={{ marginBottom: \"2rem\" }} layout={\"inline\"}>\r\n      <Form.Item>\r\n        {/*setParam(Object.assign({}, param, {name:evt.target.value}))*/}\r\n        <Input\r\n          placeholder={\"项目名\"}\r\n          type=\"text\"\r\n          value={param.name}\r\n          onChange={(evt) =>\r\n            setParam({\r\n              ...param,\r\n              name: evt.target.value,\r\n            })\r\n          }\r\n        />\r\n      </Form.Item>\r\n      <Form.Item>\r\n        <UserSelect\r\n          defaultOptionName={\"负责人\"}\r\n          value={param.personId}\r\n          onChange={(value) =>\r\n            setParam({\r\n              ...param,\r\n              personId: value,\r\n            })\r\n          }\r\n        />\r\n      </Form.Item>\r\n    </Form>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Rate } from \"antd\";\r\n\r\ninterface PinProps extends React.ComponentProps<typeof Rate> {\r\n  checked: boolean;\r\n  onCheckedChange?: (checked: boolean) => void;\r\n}\r\n\r\nexport const Pin = ({ checked, onCheckedChange, ...restProps }: PinProps) => {\r\n  return (\r\n    <Rate\r\n      count={1}\r\n      value={checked ? 1 : 0}\r\n      onChange={(num) => onCheckedChange?.(!!num)}\r\n      {...restProps}\r\n    />\r\n  );\r\n};\r\n","import { useHttp } from \"utils/http\";\r\nimport { QueryKey, useMutation, useQuery } from \"react-query\";\r\nimport {\r\n  useAddConfig,\r\n  useDeleteConfig,\r\n  useEditConfig,\r\n} from \"utils/use-optimistic-options\";\r\nimport { Project } from \"types/project\";\r\nimport { cleanObject } from \"utils/index\";\r\n\r\nexport const useProjects = (param?: Partial<Project>) => {\r\n  const client = useHttp();\r\n  \r\n  return useQuery<Project[]>([\"projects\", cleanObject(param)], () =>\r\n    client(\"projects\", { data: param })\r\n  );\r\n};\r\n\r\nexport const useEditProject = (queryKey: QueryKey) => {\r\n  const client = useHttp();\r\n  return useMutation(\r\n    (params: Partial<Project>) =>\r\n      client(`projects/${params.id}`, {\r\n        method: \"PATCH\",\r\n        data: params,\r\n      }),\r\n    useEditConfig(queryKey)\r\n  );\r\n};\r\n\r\nexport const useAddProject = (queryKey: QueryKey) => {\r\n  const client = useHttp();\r\n\r\n  return useMutation(\r\n    (params: Partial<Project>) =>\r\n      client(`projects`, {\r\n        data: params,\r\n        method: \"POST\",\r\n      }),\r\n    useAddConfig(queryKey)\r\n  );\r\n};\r\n\r\nexport const useDeleteProject = (queryKey: QueryKey) => {\r\n  const client = useHttp();\r\n\r\n  return useMutation(\r\n    ({ id }: { id: number }) =>\r\n      client(`projects/${id}`, {\r\n        method: \"DELETE\",\r\n      }),\r\n    useDeleteConfig(queryKey)\r\n  );\r\n};\r\n\r\nexport const useProject = (id?: number) => {\r\n  const client = useHttp();\r\n  return useQuery<Project>(\r\n    [\"project\", { id }],\r\n    () => client(`projects/${id}`),\r\n    {\r\n      enabled: Boolean(id),\r\n    }\r\n  );\r\n};\r\n","import { URLSearchParamsInit, useSearchParams } from \"react-router-dom\";\r\nimport { useMemo, useState } from \"react\";\r\nimport { cleanObject, subset } from \"utils/index\";\r\n\r\n/**\r\n * 返回页面url中，指定键的参数值\r\n */\r\nexport const useUrlQueryParam = <K extends string>(keys: K[]) => {\r\n  const [searchParams] = useSearchParams();\r\n  const setSearchParams = useSetUrlSearchParam();\r\n  const [stateKeys] = useState(keys);\r\n  return [\r\n    useMemo(\r\n      () =>\r\n        subset(Object.fromEntries(searchParams), stateKeys) as {\r\n          [key in K]: string;\r\n        },\r\n      [searchParams, stateKeys]\r\n    ),\r\n    (params: Partial<{ [key in K]: unknown }>) => {\r\n      return setSearchParams(params);\r\n    },\r\n  ] as const;\r\n};\r\n\r\nexport const useSetUrlSearchParam = () => {\r\n  const [searchParams, setSearchParam] = useSearchParams();\r\n  return (params: { [key in string]: unknown }) => {\r\n    const o = cleanObject({\r\n      ...Object.fromEntries(searchParams),\r\n      ...params,\r\n    }) as URLSearchParamsInit;\r\n    return setSearchParam(o);\r\n  };\r\n};\r\n","import { useSetUrlSearchParam, useUrlQueryParam } from \"utils/url\";\r\nimport { useMemo } from \"react\";\r\nimport { useProject } from \"utils/project\";\r\n\r\n// 项目列表搜索的参数\r\nexport const useProjectsSearchParams = () => {\r\n  const [param, setParam] = useUrlQueryParam([\"name\", \"personId\"]);\r\n  return [\r\n    useMemo(\r\n      () => ({ ...param, personId: Number(param.personId) || undefined }),\r\n      [param]\r\n    ),\r\n    setParam,\r\n  ] as const;\r\n};\r\n\r\nexport const useProjectsQueryKey = () => {\r\n  const [params] = useProjectsSearchParams();\r\n  return [\"projects\", params];\r\n};\r\n\r\nexport const useProjectModal = () => {\r\n  const [{ projectCreate }, setProjectCreate] = useUrlQueryParam([\r\n    \"projectCreate\",\r\n  ]);\r\n  const [{ editingProjectId }, setEditingProjectId] = useUrlQueryParam([\r\n    \"editingProjectId\",\r\n  ]);\r\n  const setUrlParams = useSetUrlSearchParam();\r\n  const { data: editingProject, isLoading } = useProject(\r\n    Number(editingProjectId)\r\n  );\r\n\r\n  const open = () => setProjectCreate({ projectCreate: true });\r\n  const close = () => setUrlParams({ projectCreate: \"\", editingProjectId: \"\" });\r\n  const startEdit = (id: number) =>\r\n    setEditingProjectId({ editingProjectId: id });\r\n\r\n  return {\r\n    projectModalOpen: projectCreate === \"true\" || Boolean(editingProjectId),\r\n    open,\r\n    close,\r\n    startEdit,\r\n    editingProject,\r\n    isLoading,\r\n  };\r\n};\r\n","import React from \"react\";\r\nimport { Dropdown, Menu, Modal, Table } from \"antd\";\r\nimport { TableProps } from \"antd/es/table\";\r\n// react-router 和 react-router-dom的关系，类似于 react 和 react-dom/react-native/react-vr...\r\nimport { Link } from \"react-router-dom\";\r\nimport { Pin } from \"components/pin\";\r\nimport { useDeleteProject, useEditProject } from \"utils/project\";\r\nimport { ButtonNoPadding } from \"components/lib\";\r\nimport {\r\n  useProjectModal,\r\n  useProjectsQueryKey,\r\n} from \"screens/project-list/util\";\r\nimport { Project } from \"types/project\";\r\nimport { User } from \"types/user\";\r\nimport moment from \"moment\";\r\n\r\ninterface ListProps extends TableProps<Project> {\r\n  users: User[];\r\n}\r\n\r\nexport const List = ({ users, ...props }: ListProps) => {\r\n  \r\n  const { mutate } = useEditProject(useProjectsQueryKey());\r\n  const pinProject = (id: number) => (pin: boolean) => mutate({ id, pin });\r\n  return (\r\n    <Table\r\n      rowKey={\"id\"}\r\n      pagination={false}\r\n      columns={[\r\n        {\r\n          title: <Pin checked={true} disabled={true} />,\r\n          render(value, project) {\r\n            return (\r\n              <Pin\r\n                checked={project.pin}\r\n                onCheckedChange={pinProject(project.id)}\r\n              />\r\n            );\r\n          },\r\n        },\r\n        {\r\n          title: \"名称\",\r\n          sorter: (a, b) => a.name.localeCompare(b.name),\r\n          render(value, project) {\r\n            \r\n            return <Link to={String(project.id)}>{project.name}</Link>;\r\n          },\r\n        },\r\n        {\r\n          title: \"部门\",\r\n          dataIndex: \"organization\",\r\n        },\r\n        {\r\n          title: \"负责人\",\r\n          render(value, project) {\r\n            return (\r\n              <span>\r\n                {users.find((user) => user.id === project.personId)?.name ||\r\n                  \"未知\"}\r\n              </span>\r\n            );\r\n          },\r\n        },\r\n        {\r\n          title: \"创建时间\",\r\n          render(value, project) {\r\n            \r\n            return (\r\n              <span>\r\n                {project.created\r\n                  ? moment(project.created).format(\"YYYY-MM-DD\")\r\n                  : \"无\"}\r\n              </span>\r\n            );\r\n          },\r\n        },\r\n        {\r\n          render(value, project) {\r\n            return <More project={project} />;\r\n          },\r\n        },\r\n      ]}\r\n      {...props}\r\n    />\r\n  );\r\n};\r\n\r\nconst More = ({ project }: { project: Project }) => {\r\n  const { startEdit } = useProjectModal();\r\n  const editProject = (id: number) => () => startEdit(id);\r\n  const { mutate: deleteProject } = useDeleteProject(useProjectsQueryKey());\r\n  const confirmDeleteProject = (id: number) => {\r\n    Modal.confirm({\r\n      title: \"确定删除这个项目吗?\",\r\n      content: \"点击确定删除\",\r\n      okText: \"确定\",\r\n      onOk() {\r\n        deleteProject({ id });\r\n      },\r\n    });\r\n  };\r\n  return (\r\n    <Dropdown\r\n      overlay={\r\n        <Menu>\r\n          <Menu.Item onClick={editProject(project.id)} key={\"edit\"}>\r\n            编辑\r\n          </Menu.Item>\r\n          <Menu.Item\r\n            onClick={() => confirmDeleteProject(project.id)}\r\n            key={\"delete\"}\r\n          >\r\n            删除\r\n          </Menu.Item>\r\n        </Menu>\r\n      }\r\n    >\r\n      <ButtonNoPadding type={\"link\"}>...</ButtonNoPadding>\r\n    </Dropdown>\r\n  );\r\n};\r\n","import React, { ProfilerOnRenderCallback, ProfilerProps } from \"react\";\r\n\r\ntype Props = { metadata?: any; phases?: (\"mount\" | \"update\")[] } & Omit<\r\n  ProfilerProps,\r\n  \"onRender\"\r\n>;\r\n\r\nlet queue: unknown[] = [];\r\n\r\nconst sendProfileQueue = () => {\r\n  if (!queue.length) {\r\n    return;\r\n  }\r\n  const queueToSend = [...queue];\r\n  queue = [];\r\n  console.log(queueToSend);\r\n};\r\n\r\nsetInterval(sendProfileQueue, 5000);\r\n\r\nexport const Profiler = ({ metadata, phases, ...props }: Props) => {\r\n  const reportProfile: ProfilerOnRenderCallback = (\r\n    id,\r\n    phase,\r\n    actualDuration,\r\n    baseDuration,\r\n    startTime,\r\n    commitTime,\r\n    interactions\r\n  ) => {\r\n    if (!phases || phases.includes(phase)) {\r\n      queue.push({\r\n        id,\r\n        phase,\r\n        actualDuration,\r\n        baseDuration,\r\n        startTime,\r\n        commitTime,\r\n        interactions,\r\n        metadata,\r\n      });\r\n    }\r\n  };\r\n\r\n  return <React.Profiler onRender={reportProfile} {...props} />;\r\n};\r\n","import React from \"react\";\r\nimport { SearchPanel } from \"screens/project-list/search-panel\";\r\nimport { List } from \"screens/project-list/list\";\r\nimport { useDebounce, useDocumentTitle } from \"utils\";\r\nimport { useProjects } from \"utils/project\";\r\nimport { useUsers } from \"utils/user\";\r\nimport {\r\n  useProjectModal,\r\n  useProjectsSearchParams,\r\n} from \"screens/project-list/util\";\r\nimport {\r\n  ButtonNoPadding,\r\n  ErrorBox,\r\n  Row,\r\n  ScreenContainer,\r\n} from \"components/lib\";\r\nimport { Profiler } from \"components/profiler\";\r\n\r\n\r\nexport const ProjectListScreen = () => {\r\n  useDocumentTitle(\"项目列表\", false);\r\n\r\n  const { open } = useProjectModal();\r\n\r\n  const [param, setParam] = useProjectsSearchParams();\r\n  const { isLoading, error, data: list } = useProjects(useDebounce(param, 200));\r\n  const { data: users } = useUsers();\r\n  \r\n  return (\r\n    <Profiler id={\"项目列表\"}>\r\n      <ScreenContainer>\r\n        <Row marginBottom={2} between={true}>\r\n          <h1>项目列表</h1>\r\n          <ButtonNoPadding onClick={open} type={\"link\"}>\r\n            创建项目\r\n          </ButtonNoPadding>\r\n        </Row>\r\n        <SearchPanel users={users || []} param={param} setParam={setParam} />\r\n        <ErrorBox error={error} />\r\n        <List loading={isLoading} users={users || []} dataSource={list || []} />\r\n      </ScreenContainer>\r\n    </Profiler>\r\n  );\r\n};\r\n\r\nProjectListScreen.whyDidYouRender = false;\r\n","var _defs, _g;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgSoftwareLogo(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    viewBox: \"0 0 179 32\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    focusable: \"false\",\n    \"aria-hidden\": \"true\",\n    className: \"css-sq9aeg-Logo\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"linearGradient\", {\n    x1: \"97.6553341%\",\n    y1: \"35.6591143%\",\n    x2: \"37.202032%\",\n    y2: \"75.4891864%\",\n    id: \"uid392-1\"\n  }, /*#__PURE__*/React.createElement(\"stop\", {\n    stopColor: \"#0052CC\",\n    offset: \"7%\"\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    stopColor: \"#2684FF\",\n    offset: \"100%\"\n  })), /*#__PURE__*/React.createElement(\"linearGradient\", {\n    x1: \"8.43371138%\",\n    y1: \"60.1495759%\",\n    x2: \"64.1161517%\",\n    y2: \"23.5790285%\",\n    id: \"uid392-2\"\n  }, /*#__PURE__*/React.createElement(\"stop\", {\n    stopColor: \"#0052CC\",\n    offset: \"0%\"\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    stopColor: \"#2684FF\",\n    offset: \"100%\"\n  })))), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    stroke: \"none\",\n    strokeWidth: 1,\n    fillRule: \"nonzero\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.3881081,27.9242105 C12.4881804,26.8071817 13.1062496,25.2917664 13.1062496,23.7115789 C13.1062496,22.1313915 12.4881804,20.6159762 11.3881081,19.4989474 L11.3881081,19.4989474 L3.74837838,11.7621053 L0.273513514,15.2926316 C-0.0900771727,15.6625064 -0.0900771727,16.2617042 0.273513514,16.6315789 L11.3881081,27.9242105 L11.3881081,27.9242105 Z\",\n    fill: \"currentColor\",\n    fillRule: \"nonzero\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M22.5027027,15.2926316 L11.3881081,4 L11.3881081,4 L11.3539189,4.03473684 L11.3539189,4.03473684 C9.08852466,6.36456187 9.09963243,10.1156459 11.3787838,12.4315789 L19.0247297,20.1652632 L22.5027027,16.6315789 C22.8662934,16.2617042 22.8662934,15.6625064 22.5027027,15.2926316 Z\",\n    fill: \"currentColor\",\n    fillRule: \"nonzero\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.3881081,12.4252632 C9.10895676,10.1093301 9.09784899,6.35824608 11.3632432,4.02842105 L3.43445946,12.0810526 L7.58067568,16.2936842 L11.3881081,12.4252632 Z\",\n    fill: \"url(#uid392-1)\",\n    fillRule: \"nonzero\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.1893243,15.6368421 L11.3881081,19.4989474 C12.4881804,20.6159762 13.1062496,22.1313915 13.1062496,23.7115789 C13.1062496,25.2917664 12.4881804,26.8071817 11.3881081,27.9242105 L19.3355405,19.8494737 L15.1893243,15.6368421 Z\",\n    fill: \"url(#uid392-2)\",\n    fillRule: \"nonzero\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M36.07,18.956 C36.07,20.646 35.394,21.842 33.418,21.842 C32.56,21.842 31.702,21.686 31,21.4 L31,23.662 C31.65,23.896 32.586,24.104 33.808,24.104 C37.032,24.104 38.41,21.946 38.41,18.8 L38.41,6.918 L36.07,6.918 L36.07,18.956 Z M41.894,7.568 C41.894,8.556 42.544,9.128 43.454,9.128 C44.364,9.128 45.014,8.556 45.014,7.568 C45.014,6.58 44.364,6.008 43.454,6.008 C42.544,6.008 41.894,6.58 41.894,7.568 Z M42.31,24 L44.546,24 L44.546,11 L42.31,11 L42.31,24 Z M47.926,24 L50.11,24 L50.11,16.33 C50.11,13.574 51.852,12.716 54.712,13.002 L54.712,10.818 C52.164,10.662 50.864,11.754 50.11,13.288 L50.11,11 L47.926,11 L47.926,24 Z M65.45,24 L65.45,21.66 C64.618,23.376 63.058,24.26 61.056,24.26 C57.598,24.26 55.856,21.322 55.856,17.5 C55.856,13.834 57.676,10.74 61.316,10.74 C63.214,10.74 64.67,11.598 65.45,13.288 L65.45,11 L67.686,11 L67.686,24 L65.45,24 Z M58.092,17.5 C58.092,20.62 59.34,22.18 61.654,22.18 C63.656,22.18 65.45,20.906 65.45,18.02 L65.45,16.98 C65.45,14.094 63.812,12.82 61.914,12.82 C59.392,12.82 58.092,14.484 58.092,17.5 Z M86.926,19.294 C86.926,16.226 84.898,15.056 81.284,14.146 C78.268,13.392 77.176,12.69 77.176,11.286 C77.176,9.726 78.502,8.946 80.738,8.946 C82.506,8.946 84.352,9.258 86.068,10.246 L86.068,7.906 C84.898,7.256 83.312,6.658 80.842,6.658 C76.864,6.658 74.836,8.634 74.836,11.286 C74.836,14.094 76.552,15.42 80.4,16.356 C83.65,17.136 84.586,17.942 84.586,19.45 C84.586,20.958 83.624,21.972 81.05,21.972 C78.788,21.972 76.344,21.374 74.758,20.542 L74.758,22.934 C76.084,23.61 77.618,24.26 80.92,24.26 C85.158,24.26 86.926,22.258 86.926,19.294 Z M95.09,24.26 C91.19,24.26 88.902,21.374 88.902,17.474 C88.902,13.574 91.19,10.74 95.09,10.74 C98.964,10.74 101.226,13.574 101.226,17.474 C101.226,21.374 98.964,24.26 95.09,24.26 Z M95.09,12.82 C92.308,12.82 91.086,15.004 91.086,17.474 C91.086,19.944 92.308,22.18 95.09,22.18 C97.846,22.18 99.042,19.944 99.042,17.474 C99.042,15.004 97.846,12.82 95.09,12.82 Z M106.92,9.622 C106.92,8.452 107.596,7.646 108.974,7.646 C109.494,7.646 109.988,7.698 110.378,7.776 L110.378,5.722 C109.988,5.618 109.546,5.514 108.87,5.514 C106.088,5.514 104.736,7.152 104.736,9.57 L104.736,11 L102.63,11 L102.63,13.08 L104.736,13.08 L104.736,24 L106.92,24 L106.92,13.08 L110.274,13.08 L110.274,11 L106.92,11 L106.92,9.622 Z M115.786,19.892 L115.786,13.08 L119.244,13.08 L119.244,11 L115.786,11 L115.786,8.244 L113.602,8.244 L113.602,11 L111.496,11 L111.496,13.08 L113.602,13.08 L113.602,19.944 C113.602,22.362 114.954,24 117.736,24 C118.412,24 118.854,23.896 119.244,23.792 L119.244,21.634 C118.854,21.712 118.36,21.816 117.84,21.816 C116.462,21.816 115.786,21.036 115.786,19.892 Z M125.432,24 L128.292,24 L130.528,17.708 L131.724,13.704 L132.92,17.708 L135.156,24 L138.016,24 L142.8,11 L140.33,11 L136.586,22.024 L132.79,11 L130.658,11 L126.862,22.024 L123.118,11 L120.648,11 L125.432,24 Z M153.538,24 L153.538,21.66 C152.706,23.376 151.146,24.26 149.144,24.26 C145.686,24.26 143.944,21.322 143.944,17.5 C143.944,13.834 145.764,10.74 149.404,10.74 C151.302,10.74 152.758,11.598 153.538,13.288 L153.538,11 L155.774,11 L155.774,24 L153.538,24 Z M146.18,17.5 C146.18,20.62 147.428,22.18 149.742,22.18 C151.744,22.18 153.538,20.906 153.538,18.02 L153.538,16.98 C153.538,14.094 151.9,12.82 150.002,12.82 C147.48,12.82 146.18,14.484 146.18,17.5 Z M159.154,24 L161.338,24 L161.338,16.33 C161.338,13.574 163.08,12.716 165.94,13.002 L165.94,10.818 C163.392,10.662 162.092,11.754 161.338,13.288 L161.338,11 L159.154,11 L159.154,24 Z M178.108,23.48 C177.042,24.052 175.404,24.26 174.078,24.26 C169.216,24.26 167.084,21.452 167.084,17.474 C167.084,13.548 169.268,10.74 173.22,10.74 C177.224,10.74 178.836,13.522 178.836,17.474 L178.836,18.488 L169.346,18.488 C169.658,20.698 171.088,22.128 174.156,22.128 C175.664,22.128 176.938,21.842 178.108,21.426 L178.108,23.48 Z M173.116,12.768 C170.75,12.768 169.554,14.302 169.32,16.564 L176.574,16.564 C176.444,14.146 175.352,12.768 173.116,12.768 Z\",\n    fill: \"inherit\",\n    fillRule: \"evenodd\"\n  }))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgSoftwareLogo);\nexport default __webpack_public_path__ + \"static/media/software-logo.8043cb5b.svg\";\nexport { ForwardRef as ReactComponent };","import { useHttp } from \"utils/http\";\r\nimport { QueryKey, useMutation, useQuery } from \"react-query\";\r\nimport { Task } from \"types/task\";\r\nimport {\r\n  useAddConfig,\r\n  useDeleteConfig,\r\n  useEditConfig,\r\n  useReorderTaskConfig,\r\n} from \"utils/use-optimistic-options\";\r\nimport { Project } from \"types/project\";\r\nimport { SortProps } from \"utils/kanban\";\r\n\r\nexport const useTasks = (param?: Partial<Task>) => {\r\n  const client = useHttp();\r\n\r\n  return useQuery<Task[]>([\"tasks\", param], () =>\r\n    client(\"tasks\", { data: param })\r\n  );\r\n};\r\n\r\nexport const useAddTask = (queryKey: QueryKey) => {\r\n  const client = useHttp();\r\n\r\n  return useMutation(\r\n    (params: Partial<Task>) =>\r\n      client(`tasks`, {\r\n        data: params,\r\n        method: \"POST\",\r\n      }),\r\n    useAddConfig(queryKey)\r\n  );\r\n};\r\n\r\nexport const useTask = (id?: number) => {\r\n  const client = useHttp();\r\n  return useQuery<Project>([\"task\", { id }], () => client(`tasks/${id}`), {\r\n    enabled: Boolean(id),\r\n  });\r\n};\r\n\r\nexport const useEditTask = (queryKey: QueryKey) => {\r\n  const client = useHttp();\r\n  return useMutation(\r\n    (params: Partial<Task>) =>\r\n      client(`tasks/${params.id}`, {\r\n        method: \"PATCH\",\r\n        data: params,\r\n      }),\r\n    useEditConfig(queryKey)\r\n  );\r\n};\r\n\r\nexport const useDeleteTask = (queryKey: QueryKey) => {\r\n  const client = useHttp();\r\n\r\n  return useMutation(\r\n    ({ id }: { id: number }) =>\r\n      client(`tasks/${id}`, {\r\n        method: \"DELETE\",\r\n      }),\r\n    useDeleteConfig(queryKey)\r\n  );\r\n};\r\n\r\nexport const useReorderTask = (queryKey: QueryKey) => {\r\n  const client = useHttp();\r\n  return useMutation((params: SortProps) => {\r\n    return client(\"tasks/reorder\", {\r\n      data: params,\r\n      method: \"POST\",\r\n    });\r\n  }, useReorderTaskConfig(queryKey));\r\n};\r\n","import { useLocation } from \"react-router\";\r\nimport { useProject } from \"utils/project\";\r\nimport { useUrlQueryParam } from \"utils/url\";\r\nimport { useCallback, useMemo } from \"react\";\r\nimport { useTask } from \"utils/task\";\r\nimport { useDebounce } from \"utils\";\r\n\r\nexport const useProjectIdInUrl = () => {\r\n  const { pathname } = useLocation();\r\n  const id = pathname.match(/projects\\/(\\d+)/)?.[1];\r\n  return Number(id);\r\n};\r\n\r\nexport const useProjectInUrl = () => useProject(useProjectIdInUrl());\r\n\r\nexport const useKanbanSearchParams = () => ({ projectId: useProjectIdInUrl() });\r\n\r\nexport const useKanbansQueryKey = () => [\"kanbans\", useKanbanSearchParams()];\r\n\r\nexport const useTasksSearchParams = () => {\r\n  const [param, setParam] = useUrlQueryParam([\r\n    \"name\",\r\n    \"typeId\",\r\n    \"processorId\",\r\n    \"tagId\",\r\n  ]);\r\n  const projectId = useProjectIdInUrl();\r\n  const debouncedName = useDebounce(param.name, 200);\r\n  return useMemo(\r\n    () => ({\r\n      projectId,\r\n      typeId: Number(param.typeId) || undefined,\r\n      processorId: Number(param.processorId) || undefined,\r\n      tagId: Number(param.tagId) || undefined,\r\n      name: debouncedName,\r\n    }),\r\n    [projectId, param, debouncedName]\r\n  );\r\n};\r\n\r\nexport const useTasksQueryKey = () => [\"tasks\", useTasksSearchParams()];\r\n\r\nexport const useTasksModal = () => {\r\n  const [{ editingTaskId }, setEditingTaskId] = useUrlQueryParam([\r\n    \"editingTaskId\",\r\n  ]);\r\n  const { data: editingTask, isLoading } = useTask(Number(editingTaskId));\r\n  \r\n  \r\n  const startEdit = useCallback(\r\n    (id: number) => {\r\n      setEditingTaskId({ editingTaskId: id });\r\n    },\r\n    [setEditingTaskId]\r\n  );\r\n  const close = useCallback(() => {\r\n    setEditingTaskId({ editingTaskId: \"\" });\r\n  }, [setEditingTaskId]);\r\n  return {\r\n    editingTaskId,\r\n    editingTask,\r\n    startEdit,\r\n    close,\r\n    isLoading,\r\n  };\r\n};\r\n","import { useHttp } from \"utils/http\";\r\nimport { useQuery } from \"react-query\";\r\nimport { TaskType } from \"types/task-type\";\r\n\r\nexport const useTaskTypes = () => {\r\n  const client = useHttp();\r\n\r\n  return useQuery<TaskType[]>([\"taskTypes\"], () => client(\"taskTypes\"));\r\n};\r\n","export default __webpack_public_path__ + \"static/media/task.8118694e.svg\";","export default __webpack_public_path__ + \"static/media/bug.bc7dca9d.svg\";","import React, { useEffect, useState } from \"react\";\r\nimport { useAddTask } from \"utils/task\";\r\nimport { useProjectIdInUrl, useTasksQueryKey } from \"screens/kanban/util\";\r\nimport { Card, Input } from \"antd\";\r\n\r\nexport const CreateTask = ({ kanbanId }: { kanbanId: number }) => {\r\n  const [name, setName] = useState(\"\");\r\n  const { mutateAsync: addTask } = useAddTask(useTasksQueryKey());\r\n  const projectId = useProjectIdInUrl();\r\n  const [inputMode, setInputMode] = useState(false);\r\n\r\n  const submit = async () => {\r\n    await addTask({ projectId, name, kanbanId });\r\n    setInputMode(false);\r\n    setName(\"\");\r\n  };\r\n\r\n  const toggle = () => setInputMode((mode) => !mode);\r\n\r\n  useEffect(() => {\r\n    if (!inputMode) {\r\n      setName(\"\");\r\n    }\r\n  }, [inputMode]);\r\n\r\n  if (!inputMode) {\r\n    return <div onClick={toggle}>+创建事务</div>;\r\n  }\r\n\r\n  return (\r\n    <Card>\r\n      <Input\r\n        onBlur={toggle}\r\n        placeholder={\"需要做些什么\"}\r\n        autoFocus={true}\r\n        onPressEnter={submit}\r\n        value={name}\r\n        onChange={(evt) => setName(evt.target.value)}\r\n      />\r\n    </Card>\r\n  );\r\n};\r\n","import React from \"react\";\r\n\r\nexport const Mark = ({ name, keyword }: { name: string; keyword: string }) => {\r\n  if (!keyword) {\r\n    return <>{name}</>;\r\n  }\r\n  const arr = name.split(keyword);\r\n  return (\r\n    <>\r\n      {arr.map((str, index) => (\r\n        <span key={index}>\r\n          {str}\r\n          {index === arr.length - 1 ? null : (\r\n            <span style={{ color: \"#257AFD\" }}>{keyword}</span>\r\n          )}\r\n        </span>\r\n      ))}\r\n    </>\r\n  );\r\n};\r\n","import { useHttp } from \"utils/http\";\r\nimport { QueryKey, useMutation, useQuery } from \"react-query\";\r\nimport { Kanban } from \"types/kanban\";\r\nimport {\r\n  useAddConfig,\r\n  useDeleteConfig,\r\n  useReorderKanbanConfig,\r\n} from \"utils/use-optimistic-options\";\r\n\r\nexport const useKanbans = (param?: Partial<Kanban>) => {\r\n  const client = useHttp();\r\n\r\n  return useQuery<Kanban[]>([\"kanbans\", param], () =>\r\n    client(\"kanbans\", { data: param })\r\n  );\r\n};\r\n\r\nexport const useAddKanban = (queryKey: QueryKey) => {\r\n  const client = useHttp();\r\n\r\n  return useMutation(\r\n    (params: Partial<Kanban>) =>\r\n      client(`kanbans`, {\r\n        data: params,\r\n        method: \"POST\",\r\n      }),\r\n    useAddConfig(queryKey)\r\n  );\r\n};\r\n\r\nexport const useDeleteKanban = (queryKey: QueryKey) => {\r\n  const client = useHttp();\r\n\r\n  return useMutation(\r\n    ({ id }: { id: number }) =>\r\n      client(`kanbans/${id}`, {\r\n        method: \"DELETE\",\r\n      }),\r\n    useDeleteConfig(queryKey)\r\n  );\r\n};\r\n\r\nexport interface SortProps {\r\n  // 要重新排序的 item\r\n  fromId: number;\r\n  // 目标 item\r\n  referenceId: number;\r\n  // 放在目标item的前还是后\r\n  type: \"before\" | \"after\";\r\n  fromKanbanId?: number;\r\n  toKanbanId?: number;\r\n}\r\n\r\nexport const useReorderKanban = (queryKey: QueryKey) => {\r\n  const client = useHttp();\r\n  return useMutation((params: SortProps) => {\r\n    return client(\"kanbans/reorder\", {\r\n      data: params,\r\n      method: \"POST\",\r\n    });\r\n  }, useReorderKanbanConfig(queryKey));\r\n};\r\n","import React, { ReactNode } from \"react\";\r\nimport {\r\n  Draggable,\r\n  DraggableProps,\r\n  Droppable,\r\n  DroppableProps,\r\n  DroppableProvided,\r\n  DroppableProvidedProps,\r\n} from \"react-beautiful-dnd\";\r\n\r\ntype DropProps = Omit<DroppableProps, \"children\"> & { children: ReactNode };\r\n\r\nexport const Drop = ({ children, ...props }: DropProps) => {\r\n  return (\r\n    <Droppable {...props}>\r\n      {(provided) => {\r\n        \r\n        if (React.isValidElement(children)) {\r\n          return React.cloneElement(children, {\r\n            ...provided.droppableProps,\r\n            ref: provided.innerRef,\r\n            provided,\r\n          });\r\n        }\r\n        return <div />;\r\n      }}\r\n    </Droppable>\r\n  );\r\n};\r\n\r\ntype DropChildProps = Partial<\r\n  { provided: DroppableProvided } & DroppableProvidedProps\r\n> &\r\n  React.HTMLAttributes<HTMLDivElement>;\r\nexport const DropChild = React.forwardRef<HTMLDivElement, DropChildProps>(\r\n  ({ children, ...props }, ref) => (\r\n    <div ref={ref} {...props}>\r\n      {children}\r\n      {props.provided?.placeholder}\r\n    </div>\r\n  )\r\n);\r\n\r\ntype DragProps = Omit<DraggableProps, \"children\"> & { children: ReactNode };\r\nexport const Drag = ({ children, ...props }: DragProps) => {\r\n  return (\r\n    <Draggable {...props}>\r\n      {(provided) => {\r\n        if (React.isValidElement(children)) {\r\n          return React.cloneElement(children, {\r\n            ...provided.draggableProps,\r\n            ...provided.dragHandleProps,\r\n            ref: provided.innerRef,\r\n          });\r\n        }\r\n        return <div />;\r\n      }}\r\n    </Draggable>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Kanban } from \"types/kanban\";\r\nimport { useTaskTypes } from \"utils/task-type\";\r\nimport taskIcon from \"assets/task.svg\";\r\nimport bugIcon from \"assets/bug.svg\";\r\nimport styled from \"@emotion/styled\";\r\nimport { Button, Card, Dropdown, Menu, Modal } from \"antd\";\r\nimport { useTasks } from \"utils/task\";\r\nimport {\r\n  useKanbansQueryKey,\r\n  useTasksModal,\r\n  useTasksSearchParams,\r\n} from \"screens/kanban/util\";\r\nimport { CreateTask } from \"screens/kanban/create-task\";\r\nimport { Task } from \"types/task\";\r\nimport { Mark } from \"components/mark\";\r\nimport { useDeleteKanban } from \"utils/kanban\";\r\nimport { Row } from \"components/lib\";\r\nimport { Drag, Drop, DropChild } from \"components/drag-and-drop\";\r\n\r\nconst TaskTypeIcon = ({ id }: { id: number }) => {\r\n  const { data: taskTypes } = useTaskTypes();\r\n  const name = taskTypes?.find((taskType) => taskType.id === id)?.name;\r\n  if (!name) {\r\n    return null;\r\n  }\r\n  return <img alt={\"task-icon\"} src={name === \"task\" ? taskIcon : bugIcon} />;\r\n};\r\n\r\nconst TaskCard = ({ task }: { task: Task }) => {\r\n  const { startEdit } = useTasksModal();\r\n  const { name: keyword } = useTasksSearchParams();\r\n  \r\n  return (\r\n    <Card\r\n      onClick={() => startEdit(task.id)}\r\n      style={{ marginBottom: \"0.5rem\", cursor: \"pointer\" }}\r\n      key={task.id}\r\n    >\r\n      <p>\r\n        <Mark keyword={keyword} name={task.name} />\r\n      </p>\r\n      <TaskTypeIcon id={task.typeId} />\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport const KanbanColumn = React.forwardRef<\r\n  HTMLDivElement,\r\n  { kanban: Kanban }\r\n>(({ kanban, ...props }, ref) => {\r\n\r\n  const { data: allTasks } = useTasks(useTasksSearchParams());\r\n  const tasks = allTasks?.filter((task) => task.kanbanId === kanban.id);\r\n  \r\n  return (\r\n    <Container {...props} ref={ref}>\r\n      <Row between={true}>\r\n        <h3>{kanban.name}</h3>\r\n        <More kanban={kanban} key={kanban.id} />\r\n      </Row>\r\n      <TasksContainer>\r\n        <Drop\r\n          type={\"ROW\"}\r\n          direction={\"vertical\"}\r\n          droppableId={String(kanban.id)}\r\n        >\r\n          <DropChild style={{ minHeight: \"1rem\" }}>\r\n            {tasks?.map((task, taskIndex) => (\r\n              <Drag\r\n                key={task.id}\r\n                index={taskIndex}\r\n                draggableId={\"task\" + task.id}\r\n              >\r\n                <div>\r\n                  <TaskCard key={task.id} task={task} />\r\n                </div>\r\n              </Drag>\r\n            ))}\r\n          </DropChild>\r\n        </Drop>\r\n        <CreateTask kanbanId={kanban.id} />\r\n      </TasksContainer>\r\n    </Container>\r\n  );\r\n});\r\n\r\nconst More = ({ kanban }: { kanban: Kanban }) => {\r\n  const { mutateAsync } = useDeleteKanban(useKanbansQueryKey());\r\n  const startDelete = () => {\r\n    Modal.confirm({\r\n      okText: \"确定\",\r\n      cancelText: \"取消\",\r\n      title: \"确定删除看板吗\",\r\n      onOk() {\r\n        return mutateAsync({ id: kanban.id });\r\n      },\r\n    });\r\n  };\r\n  const overlay = (\r\n    <Menu>\r\n      <Menu.Item>\r\n        <Button type={\"link\"} onClick={startDelete}>\r\n          删除\r\n        </Button>\r\n      </Menu.Item>\r\n    </Menu>\r\n  );\r\n  return (\r\n    <Dropdown overlay={overlay}>\r\n      <Button type={\"link\"}>...</Button>\r\n    </Dropdown>\r\n  );\r\n};\r\n\r\nexport const Container = styled.div`\r\n  min-width: 27rem;\r\n  border-radius: 6px;\r\n  background-color: rgb(244, 245, 247);\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 0.7rem 0.7rem 1rem;\r\n  margin-right: 1.5rem;\r\n`;\r\n\r\nconst TasksContainer = styled.div`\r\n  overflow: scroll;\r\n  flex: 1;\r\n\r\n  ::-webkit-scrollbar {\r\n    display: none;\r\n  }\r\n`;\r\n","import React from \"react\";\r\nimport { IdSelect } from \"components/id-select\";\r\nimport { useTaskTypes } from \"utils/task-type\";\r\n\r\nexport const TaskTypeSelect = (\r\n  props: React.ComponentProps<typeof IdSelect>\r\n) => {\r\n  const { data: taskTypes } = useTaskTypes();\r\n  return <IdSelect options={taskTypes || []} {...props} />;\r\n};\r\n","import React from \"react\";\r\nimport { useTasksSearchParams } from \"screens/kanban/util\";\r\nimport { useSetUrlSearchParam } from \"utils/url\";\r\nimport { Row } from \"components/lib\";\r\nimport { Button, Input } from \"antd\";\r\nimport { UserSelect } from \"components/user-select\";\r\nimport { TaskTypeSelect } from \"components/task-type-select\";\r\n\r\nexport const SearchPanel = () => {\r\n  const searchParams = useTasksSearchParams();\r\n  const setSearchParams = useSetUrlSearchParam();\r\n  const reset = () => {\r\n    setSearchParams({\r\n      typeId: undefined,\r\n      processorId: undefined,\r\n      tagId: undefined,\r\n      name: undefined,\r\n    });\r\n  };\r\n\r\n  return (\r\n    <Row marginBottom={4} gap={true}>\r\n      <Input\r\n        style={{ width: \"20rem\" }}\r\n        placeholder={\"任务名\"}\r\n        value={searchParams.name}\r\n        onChange={(evt) => setSearchParams({ name: evt.target.value })}\r\n      />\r\n      <UserSelect\r\n        defaultOptionName={\"经办人\"}\r\n        value={searchParams.processorId}\r\n        onChange={(value) => setSearchParams({ processorId: value })}\r\n      />\r\n      <TaskTypeSelect\r\n        defaultOptionName={\"类型\"}\r\n        value={searchParams.typeId}\r\n        onChange={(value) => setSearchParams({ typeId: value })}\r\n      />\r\n      <Button onClick={reset}>清除筛选器</Button>\r\n    </Row>\r\n  );\r\n};\r\n","import React, { useState } from \"react\";\r\nimport { useKanbansQueryKey, useProjectIdInUrl } from \"screens/kanban/util\";\r\nimport { useAddKanban } from \"utils/kanban\";\r\nimport { Input } from \"antd\";\r\nimport { Container } from \"screens/kanban/kanban-column\";\r\n\r\nexport const CreateKanban = () => {\r\n  const [name, setName] = useState(\"\");\r\n  const projectId = useProjectIdInUrl();\r\n  const { mutateAsync: addKanban } = useAddKanban(useKanbansQueryKey());\r\n\r\n  const submit = async () => {\r\n    await addKanban({ name, projectId });\r\n    setName(\"\");\r\n  };\r\n\r\n  return (\r\n    <Container>\r\n      <Input\r\n        size={\"large\"}\r\n        placeholder={\"新建看板名称\"}\r\n        onPressEnter={submit}\r\n        value={name}\r\n        onChange={(evt) => setName(evt.target.value)}\r\n      />\r\n    </Container>\r\n  );\r\n};\r\n","import { useHttp } from \"utils/http\";\r\nimport { QueryKey, useMutation, useQuery } from \"react-query\";\r\nimport { useAddConfig, useDeleteConfig, useEditConfig } from \"utils/use-optimistic-options\";\r\nimport { Epic } from \"types/epic\";\r\n\r\nexport const useEpics = (param?: Partial<Epic>) => {\r\n  const client = useHttp();\r\n\r\n  return useQuery<Epic[]>([\"epics\", param], () =>\r\n    client(\"epics\", { data: param })\r\n  );\r\n};\r\n\r\nexport const useAddEpic = (queryKey: QueryKey) => {\r\n  const client = useHttp();\r\n\r\n  return useMutation(\r\n    (params: Partial<Epic>) =>\r\n      client(`epics`, {\r\n        data: params,\r\n        method: \"POST\",\r\n      }),\r\n    useAddConfig(queryKey)\r\n  );\r\n};\r\n\r\nexport const useDeleteEpic = (queryKey: QueryKey) => {\r\n  const client = useHttp();\r\n\r\n  return useMutation(\r\n    ({ id }: { id: number }) =>\r\n      client(`epics/${id}`, {\r\n        method: \"DELETE\",\r\n      }),\r\n    useDeleteConfig(queryKey)\r\n  );\r\n};\r\n\r\n\r\nexport const useEpic = (id?: number)=>{\r\n  const client = useHttp();\r\n  return useQuery<Epic>([\"epics\", { id }], () => client(`epics/${id}`), {\r\n    enabled: Boolean(id),\r\n  });\r\n}\r\n\r\nexport const useEditEpic = (queryKey: QueryKey) => {\r\n  const client = useHttp();\r\n  return useMutation(\r\n    (params: Partial<Epic>) =>\r\n      client(`epics/${params.id}`, {\r\n        method: \"PATCH\",\r\n        data: params,\r\n      }),\r\n    useEditConfig(queryKey)\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { IdSelect } from \"components/id-select\";\r\nimport { useEpics } from \"../utils/epic\";\r\nimport { useProjectIdInUrl } from \"screens/kanban/util\";\r\n\r\n\r\nexport const EpicSelect = (props: React.ComponentProps<typeof IdSelect>) => {\r\n  const { data: epics } = useEpics();\r\n  const projectId = useProjectIdInUrl()\r\n  \r\n  return <IdSelect options={epics?.filter(item=>item.projectId === projectId) || []} {...props} />;\r\n};\r\n","import React, { useEffect } from \"react\";\r\nimport { useTasksModal, useTasksQueryKey } from \"screens/kanban/util\";\r\nimport { useDeleteTask, useEditTask } from \"utils/task\";\r\nimport { Button, Form, Input, Modal } from \"antd\";\r\nimport { UserSelect } from \"components/user-select\";\r\nimport { TaskTypeSelect } from \"components/task-type-select\";\r\nimport { EpicSelect } from \"../../components/epic-select\";\r\n\r\nconst layout = {\r\n  labelCol: { span: 8 },\r\n  wrapperCol: { span: 16 },\r\n};\r\n\r\nexport const TaskModal = () => {\r\n  const [form] = Form.useForm();\r\n  const { editingTaskId, editingTask, close } = useTasksModal();\r\n  const { mutateAsync: editTask, isLoading: editLoading } = useEditTask(\r\n    useTasksQueryKey()\r\n  );\r\n  const { mutate: deleteTask } = useDeleteTask(useTasksQueryKey());\r\n\r\n  const onCancel = () => {\r\n    close();\r\n    form.resetFields();\r\n  };\r\n\r\n  const onOk = async () => {\r\n    await editTask({ ...editingTask, ...form.getFieldsValue() });\r\n    close();\r\n  };\r\n\r\n  const startDelete = () => {\r\n    close();\r\n    Modal.confirm({\r\n      okText: \"确定\",\r\n      cancelText: \"取消\",\r\n      title: \"确定删除任务吗\",\r\n      onOk() {\r\n        return deleteTask({ id: Number(editingTaskId) });\r\n      },\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    form.setFieldsValue(editingTask);\r\n  }, [form, editingTask]);\r\n\r\n  return (\r\n    <Modal\r\n      forceRender={true}\r\n      onCancel={onCancel}\r\n      onOk={onOk}\r\n      okText={\"确认\"}\r\n      cancelText={\"取消\"}\r\n      confirmLoading={editLoading}\r\n      title={\"编辑任务\"}\r\n      visible={!!editingTaskId}\r\n    >\r\n      <Form {...layout} initialValues={editingTask} form={form}>\r\n        <Form.Item\r\n          label={\"任务名\"}\r\n          name={\"name\"}\r\n          rules={[{ required: true, message: \"请输入任务名\" }]}\r\n        >\r\n          <Input />\r\n        </Form.Item>\r\n        <Form.Item label={\"任务组\"} name={\"epicId\"}>\r\n          <EpicSelect defaultOptionName={\"任务组\"} />\r\n        </Form.Item>\r\n        <Form.Item label={\"经办人\"} name={\"processorId\"}>\r\n          <UserSelect defaultOptionName={\"经办人\"} />\r\n        </Form.Item>\r\n        <Form.Item label={\"类型\"} name={\"typeId\"}>\r\n          <TaskTypeSelect />\r\n        </Form.Item>\r\n        <Form.Item label={\"备注\"} name={\"note\"}>\r\n          <Input.TextArea />\r\n        </Form.Item>\r\n      </Form>\r\n      <div style={{ textAlign: \"right\" }}>\r\n        <Button\r\n          onClick={startDelete}\r\n          style={{ fontSize: \"14px\" }}\r\n          size={\"small\"}\r\n          danger={true}\r\n        >\r\n          删除\r\n        </Button>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n","import React, { useCallback } from \"react\";\r\nimport { useDocumentTitle } from \"utils\";\r\nimport {\r\n  useKanbanSearchParams,\r\n  useKanbansQueryKey,\r\n  useProjectInUrl,\r\n  useTasksQueryKey,\r\n  useTasksSearchParams,\r\n} from \"screens/kanban/util\";\r\nimport { KanbanColumn } from \"screens/kanban/kanban-column\";\r\nimport styled from \"@emotion/styled\";\r\nimport { useKanbans, useReorderKanban } from \"utils/kanban\";\r\nimport { SearchPanel } from \"screens/kanban/search-panel\";\r\nimport { ScreenContainer } from \"components/lib\";\r\nimport { useReorderTask, useTasks } from \"utils/task\";\r\nimport { Spin } from \"antd\";\r\nimport { CreateKanban } from \"screens/kanban/create-kanban\";\r\nimport { TaskModal } from \"screens/kanban/task-modal\";\r\nimport { DragDropContext, DropResult } from \"react-beautiful-dnd\";\r\nimport { Drag, Drop, DropChild } from \"components/drag-and-drop\";\r\nimport { Profiler } from \"components/profiler\";\r\n\r\nexport const KanbanScreen = () => {\r\n  useDocumentTitle(\"看板列表\");\r\n\r\n  const { data: currentProject } = useProjectInUrl();\r\n  const { data: kanbans, isLoading: kanbanIsLoading } = useKanbans(\r\n    useKanbanSearchParams()\r\n  );\r\n  const { isLoading: taskIsLoading } = useTasks(useTasksSearchParams());\r\n  const isLoading = taskIsLoading || kanbanIsLoading;\r\n\r\n  const onDragEnd = useDragEnd();\r\n  return (\r\n      <DragDropContext onDragEnd={onDragEnd}>\r\n        <ScreenContainer>\r\n          <h1>{currentProject?.name}看板</h1>\r\n          <SearchPanel />\r\n          {isLoading ? (\r\n            <Spin size={\"large\"} />\r\n          ) : (\r\n            <ColumnsContainer>\r\n              <Drop\r\n                type={\"COLUMN\"}\r\n                direction={\"horizontal\"}\r\n                droppableId={\"kanban\"}\r\n              >\r\n                <DropChild style={{ display: \"flex\" }}>\r\n                  {kanbans?.map((kanban, index) => (\r\n                    <Drag\r\n                      key={kanban.id}\r\n                      draggableId={\"kanban\" + kanban.id}\r\n                      index={index}\r\n                    >\r\n                      <KanbanColumn kanban={kanban} key={kanban.id} />\r\n                    </Drag>\r\n                  ))}\r\n                </DropChild>\r\n              </Drop>\r\n              <CreateKanban />\r\n            </ColumnsContainer>\r\n          )}\r\n          <TaskModal />\r\n        </ScreenContainer>\r\n      </DragDropContext>\r\n  );\r\n};\r\n\r\nexport const useDragEnd = () => {\r\n  const { data: kanbans } = useKanbans(useKanbanSearchParams());\r\n  const { mutate: reorderKanban } = useReorderKanban(useKanbansQueryKey());\r\n  const { mutate: reorderTask } = useReorderTask(useTasksQueryKey());\r\n  const { data: allTasks = [] } = useTasks(useTasksSearchParams());\r\n  return useCallback(\r\n    ({ source, destination, type }: DropResult) => {\r\n      if (!destination) {\r\n        return;\r\n      }\r\n      // 看板排序\r\n      if (type === \"COLUMN\") {\r\n        const fromId = kanbans?.[source.index].id;\r\n        const toId = kanbans?.[destination.index].id;\r\n        if (!fromId || !toId || fromId === toId) {\r\n          return;\r\n        }\r\n        const type = destination.index > source.index ? \"after\" : \"before\";\r\n        reorderKanban({ fromId, referenceId: toId, type });\r\n      }\r\n      if (type === \"ROW\") {\r\n        const fromKanbanId = +source.droppableId;\r\n        const toKanbanId = +destination.droppableId;\r\n        const fromTask = allTasks.filter(\r\n          (task) => task.kanbanId === fromKanbanId\r\n        )[source.index];\r\n        const toTask = allTasks.filter((task) => task.kanbanId === toKanbanId)[\r\n          destination.index\r\n        ];\r\n        if (fromTask?.id === toTask?.id) {\r\n          return;\r\n        }\r\n        reorderTask({\r\n          fromId: fromTask?.id,\r\n          referenceId: toTask?.id,\r\n          fromKanbanId,\r\n          toKanbanId,\r\n          type:\r\n            fromKanbanId === toKanbanId && destination.index > source.index\r\n              ? \"after\"\r\n              : \"before\",\r\n        });\r\n      }\r\n    },\r\n    [kanbans, reorderKanban, allTasks, reorderTask]\r\n  );\r\n};\r\n\r\nexport const ColumnsContainer = styled(\"div\")`\r\n  display: flex;\r\n  overflow-x: scroll;\r\n  flex: 1;\r\n`;\r\n","import { useCallback } from \"react\";\r\nimport { useProjectIdInUrl } from \"screens/kanban/util\";\r\nimport { useEpic } from \"utils/epic\";\r\nimport { useUrlQueryParam } from \"utils/url\";\r\n\r\nexport const useEpicSearchParams = () => ({ projectId: useProjectIdInUrl() });\r\n\r\nexport const useEpicsQueryKey = () => [\"epics\", useEpicSearchParams()];\r\n\r\nexport const useEpicsModal = () => {\r\n  const [{ editingEpicId }, setEditingEpicId] = useUrlQueryParam([\r\n    \"editingEpicId\",\r\n  ]);\r\n  const { data: editingEpic, isLoading } = useEpic(Number(editingEpicId));\r\n  const startEdit = useCallback(\r\n    (id: number) => {\r\n    \r\n      setEditingEpicId({ editingEpicId: id });\r\n    },\r\n    [setEditingEpicId]\r\n  );\r\n  const close = useCallback(() => {\r\n    setEditingEpicId({ editingEpicId: \"\" });\r\n  }, [setEditingEpicId]);\r\n  return {\r\n    editingEpicId,\r\n    editingEpic,\r\n    startEdit,\r\n    close,\r\n    isLoading,\r\n  };\r\n};\r\n","import React, { useEffect } from \"react\";\r\nimport { Button, Drawer, Form, Input, Spin, DatePicker  } from \"antd\";\r\nimport { DrawerProps } from \"antd/es/drawer\";\r\nimport styled from \"@emotion/styled\";\r\nimport { ErrorBox } from \"components/lib\";\r\nimport { useAddEpic } from \"utils/epic\";\r\nimport { useEpicsQueryKey } from \"screens/epic/util\";\r\nimport { useProjectIdInUrl } from \"screens/kanban/util\";\r\n\r\nexport const CreateEpic = (\r\n  props: Pick<DrawerProps, \"visible\"> & { onClose: () => void }\r\n) => {\r\n  const { mutate: addEpic, isLoading, error } = useAddEpic(useEpicsQueryKey());\r\n  const [form] = Form.useForm();\r\n  const projectId = useProjectIdInUrl();\r\n\r\n  const onFinish = async (values: any) => {\r\n    \r\n    await addEpic({ ...values, projectId });\r\n    props.onClose();\r\n  };\r\n\r\n  useEffect(() => {\r\n    form.resetFields();\r\n  }, [form, props.visible]);\r\n\r\n  return (\r\n    <Drawer\r\n      visible={props.visible}\r\n      onClose={props.onClose}\r\n      forceRender={true}\r\n      destroyOnClose={true}\r\n      width={\"100%\"}\r\n    >\r\n      <Container>\r\n        {isLoading ? (\r\n          <Spin size={\"large\"} />\r\n        ) : (\r\n          <>\r\n            <h1>创建任务组</h1>\r\n            <ErrorBox error={error} />\r\n            <Form\r\n              form={form}\r\n              layout={\"vertical\"}\r\n              style={{ width: \"40rem\" }}\r\n              onFinish={onFinish}\r\n            >\r\n              <Form.Item\r\n                label={\"名称\"}\r\n                name={\"name\"}\r\n                rules={[{ required: true, message: \"请输入任务组名\" }]}\r\n              >\r\n                <Input placeholder={\"请输入任务组名称\"} />\r\n              </Form.Item>\r\n              <Form.Item\r\n                label={\"开始时间\"}\r\n                name={\"start\"}\r\n                rules={[{ required: true, message: \"请输入开始时间\" }]}\r\n              >\r\n                  <DatePicker   \r\n                  placeholder={\"请输入任务组开始时间\"}  \r\n                   style={{width: \"100%\"}}/>\r\n              </Form.Item>\r\n              <Form.Item\r\n                label={\"结束时间\"}\r\n                name={\"end\"}\r\n                rules={[{ required: true, message: \"请输入结束时间\" }]}\r\n              >\r\n                  <DatePicker   \r\n                  placeholder={\"请输入任务组结束时间\"}  \r\n                   style={{width: \"100%\"}}/>\r\n              </Form.Item>\r\n\r\n              <Form.Item style={{ textAlign: \"right\" }}>\r\n                <Button\r\n                  loading={isLoading}\r\n                  type={\"primary\"}\r\n                  htmlType={\"submit\"}\r\n                >\r\n                  提交\r\n                </Button>\r\n              </Form.Item>\r\n            </Form>\r\n          </>\r\n        )}\r\n      </Container>\r\n    </Drawer>\r\n  );\r\n};\r\n\r\nconst Container = styled.div`\r\n  height: 80vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n`;\r\n","import React, { useEffect } from \"react\";\r\nimport {  DatePicker, Form, Input, Modal } from \"antd\";\r\nimport moment from \"moment\";\r\nimport { useEpicsModal, useEpicsQueryKey } from \"./util\";\r\nimport { useEditEpic } from \"utils/epic\";\r\n\r\nconst layout = {\r\n  labelCol: { span: 8 },\r\n  wrapperCol: { span: 16 },\r\n};\r\n\r\nexport const EpicModal = () => {\r\n  const [form] = Form.useForm();\r\n  const { editingEpicId, editingEpic, close } =  useEpicsModal();\r\n  const { mutateAsync: editEpic, isLoading: editLoading } = useEditEpic(\r\n    useEpicsQueryKey()\r\n  );\r\n\r\n  const onCancel = () => {\r\n    close();\r\n    form.resetFields();\r\n  };\r\n\r\n  const onOk = async () => {\r\n    await editEpic({ ...editingEpic, ...form.getFieldsValue() });\r\n    close();\r\n  };\r\n\r\n  \r\n  useEffect(() => {\r\n    form.setFieldsValue( {...editingEpic,\r\n      start : moment(editingEpic?.start),\r\n      end : moment(editingEpic?.end)\r\n    });\r\n  }, [form, editingEpic]);\r\n\r\n  return (\r\n    <Modal\r\n      forceRender={true}\r\n      onCancel={onCancel}\r\n      onOk={onOk}\r\n      okText={\"确认\"}\r\n      cancelText={\"取消\"}\r\n      confirmLoading={editLoading}\r\n      title={\"编辑任务\"}\r\n      visible={!!editingEpicId}\r\n    >\r\n      <Form {...layout} \r\n      form={form}>\r\n        <Form.Item\r\n          label={\"任务组名\"}\r\n          name={\"name\"}\r\n          rules={[{ required: true, message: \"请输入任务组名\" }]}\r\n        >\r\n          <Input />\r\n        </Form.Item>\r\n        <Form.Item\r\n          label={\"开始时间\"}\r\n          name={\"start\"}\r\n          rules={[{ required: true, message: \"请输入开始时间\" }]}\r\n        >\r\n            <DatePicker   \r\n                  placeholder={\"请输入任务组开始时间\"}  \r\n                  style={{width: \"100%\"}}\r\n                  format=\"YYYY-MM-DD\"\r\n                  />\r\n        </Form.Item>\r\n        <Form.Item\r\n          label={\"结束时间\"}\r\n          name={\"end\"}\r\n          rules={[{ required: true, message: \"请输入结束时间\" }]}\r\n        >\r\n           <DatePicker   \r\n                  placeholder={\"请输入任务组结束时间\"}  \r\n                   style={{width: \"100%\"}}/>\r\n        </Form.Item>\r\n     \r\n      </Form>\r\n     \r\n    </Modal>\r\n  );\r\n};\r\n","import React, { useState } from \"react\";\r\nimport { Row, ScreenContainer } from \"components/lib\";\r\nimport { useProjectInUrl } from \"screens/kanban/util\";\r\nimport { useDeleteEpic, useEpics } from \"utils/epic\";\r\nimport { Button, List, Modal } from \"antd\";\r\nimport { useTasks } from \"utils/task\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useEpicSearchParams, useEpicsModal, useEpicsQueryKey } from \"screens/epic/util\";\r\nimport { Epic } from \"types/epic\";\r\nimport { CreateEpic } from \"screens/epic/create-epic\";\r\nimport { EpicModal } from \"./epic-modal\";\r\nimport moment from \"moment\";\r\nexport const EpicScreen = () => {\r\n  const { data: currentProject } = useProjectInUrl();\r\n  const { data: epics } = useEpics(useEpicSearchParams());\r\n  const { data: tasks } = useTasks({ projectId: currentProject?.id });\r\n  const { mutate: deleteEpic } = useDeleteEpic(useEpicsQueryKey());\r\n  const [epicCreateOpen, setEpicCreateOpen] = useState(false);\r\n  const { startEdit } = useEpicsModal();\r\n  const confirmDeleteEpic = (epic: Epic) => {\r\n    Modal.confirm({\r\n      title: `确定删除项目组：${epic.name}`,\r\n      content: \"点击确定删除\",\r\n      okText: \"确定\",\r\n      cancelText : \"取消\",\r\n      onOk() {\r\n        deleteEpic({ id: epic.id });\r\n      },\r\n    });\r\n  };\r\n  \r\n  \r\n  return (\r\n    <ScreenContainer>\r\n      <Row between={true}>\r\n        <h1>{currentProject?.name}任务组</h1>\r\n        <Button onClick={() => setEpicCreateOpen(true)} type={\"link\"}>\r\n          创建任务组\r\n        </Button>\r\n      </Row>\r\n      <List\r\n        style={{ overflow: \"scroll\" }}\r\n        dataSource={epics}\r\n        itemLayout={\"vertical\"}\r\n        renderItem={(epic) => (\r\n          <List.Item >\r\n            <List.Item.Meta\r\n              title={\r\n                <Row between={true}>\r\n                  <span>{epic.name}</span>\r\n                  <div>\r\n                    <Button onClick={() => startEdit(epic.id)} type={\"link\"}>\r\n                      编辑 \r\n                    </Button>\r\n                    <Button onClick={() => confirmDeleteEpic(epic)} type={\"link\"}>\r\n                      删除\r\n                    </Button>\r\n                  </div>\r\n                \r\n                </Row>\r\n              }\r\n              description={\r\n                <div>\r\n                  <div>开始时间：{moment(epic.start).format(\"YYYY-MM-DD\")}</div>\r\n                  <div>结束时间：{moment(epic.end).format(\"YYYY-MM-DD\")}</div>\r\n                </div>}\r\n              \r\n            />\r\n            <div>\r\n              {tasks\r\n                ?.filter((task) => task.epicId === epic.id)\r\n                .map((task) => (<div key={task.id} style={{display:\"inline-block\"}}>\r\n                  <Link\r\n                    to={`/projects/${currentProject?.id}/kanban?editingTaskId=${task.id}`}\r\n                  >\r\n                    {task.name}\r\n                  </Link>\r\n                  <span style={{margin : \"0 1rem\"}}> | </span>\r\n                </div>\r\n                ))}\r\n            </div>\r\n          </List.Item>\r\n        )}\r\n      />\r\n      <CreateEpic\r\n        onClose={() => setEpicCreateOpen(false)}\r\n        visible={epicCreateOpen}\r\n      />\r\n      <EpicModal/>\r\n    </ScreenContainer>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { Navigate, Route, Routes, useLocation } from \"react-router\";\r\nimport { KanbanScreen } from \"screens/kanban\";\r\nimport { EpicScreen } from \"screens/epic\";\r\nimport styled from \"@emotion/styled\";\r\nimport { Menu } from \"antd\";\r\n\r\nconst useRouteType = () => {\r\n  const units = useLocation().pathname.split(\"/\");\r\n  return units[units.length - 1];\r\n};\r\n\r\nexport const ProjectScreen = () => {\r\n  const routeType = useRouteType();\r\n  return (\r\n    <Container>\r\n      <Aside>\r\n        <Menu mode={\"inline\"} selectedKeys={[routeType]}>\r\n          <Menu.Item key={\"kanban\"}>\r\n            <Link to={\"kanban\"}>看板</Link>\r\n          </Menu.Item>\r\n          <Menu.Item key={\"epic\"}>\r\n            <Link to={\"epic\"}>任务组</Link>\r\n          </Menu.Item>\r\n        </Menu>\r\n      </Aside>\r\n      <Main>\r\n        <Routes>\r\n          {/*projects/:projectId/kanban*/}\r\n          <Route path={\"/kanban\"} element={<KanbanScreen />} />\r\n          {/*projects/:projectId/epic*/}\r\n          <Route path={\"/epic\"} element={<EpicScreen />} />\r\n          <Navigate to={window.location.pathname + \"/kanban\"} replace={true} />\r\n        </Routes>\r\n      </Main>\r\n    </Container>\r\n  );\r\n};\r\n\r\nconst Aside = styled.aside`\r\n  background-color: rgb(244, 245, 247);\r\n  display: flex;\r\n`;\r\n\r\nconst Main = styled.div`\r\n  box-shadow: -5px 0 5px -5px rgba(0, 0, 0, 0.1);\r\n  display: flex;\r\n  overflow: hidden;\r\n`;\r\n\r\nconst Container = styled.div`\r\n  display: grid;\r\n  grid-template-columns: 16rem 1fr;\r\n  width: 100%;\r\n`;\r\n","import React, { useEffect } from \"react\";\r\nimport { Button, Drawer, Form, Input, Spin } from \"antd\";\r\nimport {\r\n  useProjectModal,\r\n  useProjectsQueryKey,\r\n} from \"screens/project-list/util\";\r\nimport { UserSelect } from \"components/user-select\";\r\nimport { useAddProject, useEditProject } from \"utils/project\";\r\nimport { ErrorBox } from \"components/lib\";\r\nimport styled from \"@emotion/styled\";\r\n\r\nexport const ProjectModal = () => {\r\n  const {\r\n    projectModalOpen,\r\n    close,\r\n    editingProject,\r\n    isLoading,\r\n  } = useProjectModal();\r\n  const useMutateProject = editingProject ? useEditProject : useAddProject;\r\n\r\n  const { mutateAsync, error, isLoading: mutateLoading } = useMutateProject(\r\n    useProjectsQueryKey()\r\n  );\r\n  const [form] = Form.useForm();\r\n  const onFinish = (values: any) => {\r\n    mutateAsync({ ...editingProject, ...values }).then(() => {\r\n      form.resetFields();\r\n      close();\r\n    });\r\n  };\r\n  const closeModal = () => {\r\n    form.resetFields();\r\n    close();\r\n  };\r\n\r\n  const title = editingProject ? \"编辑项目\" : \"创建项目\";\r\n\r\n  useEffect(() => {\r\n    form.setFieldsValue(editingProject);\r\n  }, [editingProject, form]);\r\n\r\n  return (\r\n    <Drawer\r\n      forceRender={true}\r\n      onClose={closeModal}\r\n      visible={projectModalOpen}\r\n      width={\"100%\"}\r\n    >\r\n      <Container>\r\n        {isLoading ? (\r\n          <Spin size={\"large\"} />\r\n        ) : (\r\n          <>\r\n            <h1>{title}</h1>\r\n            <ErrorBox error={error} />\r\n            <Form\r\n              form={form}\r\n              layout={\"vertical\"}\r\n              style={{ width: \"40rem\" }}\r\n              onFinish={onFinish}\r\n            >\r\n              <Form.Item\r\n                label={\"名称\"}\r\n                name={\"name\"}\r\n                rules={[{ required: true, message: \"请输入项目名\" }]}\r\n              >\r\n                <Input placeholder={\"请输入项目名称\"} />\r\n              </Form.Item>\r\n\r\n              <Form.Item\r\n                label={\"部门\"}\r\n                name={\"organization\"}\r\n                rules={[{ required: true, message: \"请输入部门名\" }]}\r\n              >\r\n                <Input placeholder={\"请输入部门名\"} />\r\n              </Form.Item>\r\n\r\n              <Form.Item label={\"负责人\"} name={\"personId\"}>\r\n                <UserSelect defaultOptionName={\"负责人\"} />\r\n              </Form.Item>\r\n\r\n              <Form.Item style={{ textAlign: \"right\" }}>\r\n                <Button\r\n                  loading={mutateLoading}\r\n                  type={\"primary\"}\r\n                  htmlType={\"submit\"}\r\n                >\r\n                  提交\r\n                </Button>\r\n              </Form.Item>\r\n            </Form>\r\n          </>\r\n        )}\r\n      </Container>\r\n    </Drawer>\r\n  );\r\n};\r\n\r\nconst Container = styled.div`\r\n  height: 80vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n`;\r\n","import React from \"react\";\r\nimport { Divider, List, Popover, Typography } from \"antd\";\r\nimport { useProjects } from \"utils/project\";\r\nimport styled from \"@emotion/styled\";\r\nimport { ButtonNoPadding } from \"components/lib\";\r\nimport { useProjectModal } from \"screens/project-list/util\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nexport const ProjectPopover = () => {\r\n  const { open } = useProjectModal();\r\n  const { data: projects, refetch } = useProjects();\r\n  const pinnedProjects = projects?.filter((project) => project.pin);\r\n  const content = (\r\n    <ContentContainer>\r\n      <Typography.Text type={\"secondary\"}>收藏项目</Typography.Text>\r\n      <List>\r\n        {pinnedProjects?.map((project) => (\r\n          <List.Item key={project.id} >\r\n            <List.Item.Meta title={  \r\n             <Link to={ `projects/${ project.id}/kanban`}>{project.name}</Link>\r\n            } />\r\n          </List.Item>\r\n        ))}\r\n      </List>\r\n      <Divider />\r\n      <ButtonNoPadding onClick={open} type={\"link\"}>\r\n        创建项目\r\n      </ButtonNoPadding>\r\n    </ContentContainer>\r\n  );\r\n\r\n  return (\r\n    <Popover\r\n      onVisibleChange={() => refetch()}\r\n      placement={\"bottom\"}\r\n      content={content}\r\n    >\r\n      <CursorPointer >项目</CursorPointer>\r\n    </Popover>\r\n  );\r\n};\r\n\r\nconst ContentContainer = styled.div`\r\n  min-width: 30rem;\r\n`;\r\n\r\nconst CursorPointer = styled.span` \r\n  cursor: pointer;\r\n`\r\n","import React, { useEffect, useState } from \"react\";\r\nimport {  Input } from \"antd\";\r\nimport { ButtonNoPadding } from \"./lib\";\r\nimport { useAddUser } from \"utils/user\";\r\n\r\nexport const CreateUser = () => {\r\n  const [name, setName] = useState(\"\");\r\n  const { mutateAsync: addUser } = useAddUser();\r\n  const [inputMode, setInputMode] = useState(false);\r\n\r\n  const submit = async () => {\r\n    await addUser({  name });\r\n    setInputMode(false);\r\n    setName(\"\");\r\n  };\r\n\r\n  const toggle = () => setInputMode((mode) => !mode);\r\n\r\n  useEffect(() => {\r\n    if (!inputMode) {\r\n      setName(\"\");\r\n    }\r\n  }, [inputMode]);\r\n\r\n  if (!inputMode) {\r\n    return <ButtonNoPadding onClick={toggle} type={\"link\"}>\r\n        增加组员\r\n    </ButtonNoPadding>\r\n  }\r\n\r\n  return (\r\n    <Input\r\n    onBlur={toggle}\r\n    placeholder={\"添加组员\"}\r\n    autoFocus={true}\r\n    onPressEnter={submit}\r\n    value={name}\r\n    onChange={(evt) => setName(evt.target.value)}\r\n    />\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Button, Divider, List, Modal, Popover, Typography } from \"antd\";\r\nimport styled from \"@emotion/styled\";\r\nimport { useDeleteUser, useUsers } from \"utils/user\";\r\nimport { CreateUser } from \"./create-user\";\r\nimport { User } from \"types/user\";\r\n\r\nexport const UserPopover = () => {\r\n  const { data: users, refetch } = useUsers();\r\n  const { mutateAsync: deleteUser } = useDeleteUser();\r\n\r\n  const startDelete = (user:User) => {\r\n  \r\n    Modal.confirm({\r\n      okText: \"确定\",\r\n      cancelText: \"取消\",\r\n      title: \"确定删除任务吗\",\r\n      onOk() {\r\n        return deleteUser({ id: Number(user.id) });\r\n      },\r\n    });\r\n  };\r\n\r\n  const content = (\r\n    <ContentContainer>\r\n      <Typography.Text type={\"secondary\"}>组员列表</Typography.Text>\r\n      <List>\r\n        {users?.map((user) => (\r\n          <List.Item key={user.id}>\r\n            <List.Item.Meta title={ \r\n              <Flex>\r\n                <span>{user.name}</span>\r\n                <Button type={\"link\"} danger={true} onClick={()=>startDelete(user)}>删除</Button>\r\n              </Flex>\r\n            } />\r\n          </List.Item>\r\n        ))}\r\n      </List>\r\n      <Divider />\r\n      <CreateUser />\r\n     \r\n    </ContentContainer>\r\n  );\r\n\r\n  return (\r\n    <Popover\r\n      onVisibleChange={() => refetch()}\r\n      placement={\"bottom\"}\r\n      content={content}\r\n    >\r\n      <CursorPointer>组员</CursorPointer>\r\n    </Popover>\r\n  );\r\n};\r\n\r\nconst ContentContainer = styled.div`\r\n  min-width: 30rem;\r\n`;\r\n\r\nconst CursorPointer = styled.span` \r\n  cursor: pointer;\r\n`\r\n\r\nconst Flex = styled.div`\r\n  display: flex;\r\n  justify-content: space-between ;\r\n\r\n`\r\n\r\n","import React from \"react\";\r\nimport { ProjectListScreen } from \"screens/project-list\";\r\nimport { useAuth } from \"context/auth-context\";\r\nimport { ReactComponent as SoftwareLogo } from \"assets/software-logo.svg\";\r\nimport styled from \"@emotion/styled\";\r\nimport { ButtonNoPadding, Row } from \"components/lib\";\r\nimport { Button, Dropdown, Menu } from \"antd\";\r\nimport { Navigate, Route, Routes } from \"react-router\";\r\nimport { ProjectScreen } from \"screens/project\";\r\nimport { resetRoute } from \"utils\";\r\nimport { ProjectModal } from \"screens/project-list/project-modal\";\r\nimport { ProjectPopover } from \"components/project-popover\";\r\nimport { UserPopover } from \"components/user-popover\";\r\n\r\n\r\n\r\nexport default function AuthenticatedApp() {\r\n  return (\r\n    <Container>\r\n      <PageHeader />\r\n      <Main>\r\n        <Routes>\r\n          <Route path={\"/projects\"} element={<ProjectListScreen />} />\r\n          <Route path={\"/projects/:projectId/*\"} element={<ProjectScreen />} />\r\n          <Navigate to={\"/projects\"} />\r\n        </Routes>\r\n      </Main>\r\n      <ProjectModal />\r\n    </Container>\r\n  );\r\n}\r\n\r\nconst PageHeader = () => {\r\n  return (\r\n    <Header between={true}>\r\n      <HeaderLeft gap={true}>\r\n        <ButtonNoPadding type={\"link\"} onClick={resetRoute}>\r\n          <SoftwareLogo width={\"18rem\"} color={\"rgb(38, 132, 255)\"} />\r\n        </ButtonNoPadding>\r\n        <ProjectPopover />\r\n        <UserPopover />\r\n      </HeaderLeft>\r\n      <HeaderRight>\r\n        <User />\r\n      </HeaderRight>\r\n    </Header>\r\n  );\r\n};\r\n\r\nconst User = () => {\r\n  const { logout, user } = useAuth();\r\n  return (\r\n    <Dropdown\r\n      overlay={\r\n        <Menu>\r\n          <Menu.Item key={\"logout\"}>\r\n            <Button onClick={logout} type={\"link\"}>\r\n              登出\r\n            </Button>\r\n          </Menu.Item>\r\n        </Menu>\r\n      }\r\n    >\r\n      <Button type={\"link\"} onClick={(e) => e.preventDefault()}>\r\n        Hi, {user?.name}\r\n      </Button>\r\n    </Dropdown>\r\n  );\r\n};\r\n\r\n// temporal dead zone(暂时性死区)\r\nconst Container = styled.div`\r\n  display: grid;\r\n  grid-template-rows: 6rem 1fr;\r\n  height: 100vh;\r\n`;\r\n\r\n// grid-area 用来给grid子元素起名字\r\nconst Header = styled(Row)`\r\n  padding: 3.2rem;\r\n  box-shadow: 0 0 5px 0 rgba(0, 0, 0, 0.1);\r\n  z-index: 1;\r\n`;\r\nconst HeaderLeft = styled(Row)``;\r\nconst HeaderRight = styled.div``;\r\nconst Main = styled.main`\r\n  display: flex;\r\n  overflow: hidden;\r\n`;\r\n"],"sourceRoot":""}